<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Inductobot.Views.LogViewerPage"
             Title="Log Viewer">

    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="10">
        
        <!-- Header Controls -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto,Auto,Auto" ColumnSpacing="10" Margin="0,0,0,10">
            <Entry Grid.Column="0" 
                   x:Name="SearchEntry" 
                   Placeholder="Search logs..." 
                   TextChanged="OnSearchTextChanged"/>
            
            <Picker Grid.Column="1" 
                    x:Name="LogLevelPicker" 
                    WidthRequest="120"
                    SelectedIndexChanged="OnLogLevelChanged">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>All Levels</x:String>
                        <x:String>Critical</x:String>
                        <x:String>Error</x:String>
                        <x:String>Warning</x:String>
                        <x:String>Information</x:String>
                        <x:String>Debug</x:String>
                        <x:String>Trace</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>
            
            <Button Grid.Column="2" 
                    x:Name="RefreshButton"
                    Text="Refresh" 
                    Clicked="OnRefreshClicked"/>
            
            <Button Grid.Column="3" 
                    x:Name="ExportButton"
                    Text="Export" 
                    Clicked="OnExportClicked"/>
        </Grid>
        
        <!-- Log Files Section -->
        <Frame Grid.Row="1" 
               BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#1E1E1E}"
               BorderColor="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"
               Padding="10"
               Margin="0,0,0,10">
            <VerticalStackLayout Spacing="5">
                <Label Text="Log Files" FontSize="16" FontAttributes="Bold"/>
                <CollectionView x:Name="LogFilesCollectionView" 
                               HeightRequest="120"
                               SelectionMode="Single"
                               SelectionChanged="OnLogFileSelected">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10" Padding="5">
                                <Label Grid.Column="0" 
                                       Text="{Binding FileName}" 
                                       FontSize="14" 
                                       VerticalOptions="Center"/>
                                <Label Grid.Column="1" 
                                       Text="{Binding FormattedSize}" 
                                       FontSize="12" 
                                       TextColor="Gray" 
                                       VerticalOptions="Center"/>
                                <Label Grid.Column="2" 
                                       Text="{Binding FormattedAge}" 
                                       FontSize="12" 
                                       TextColor="Gray" 
                                       VerticalOptions="Center"/>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Frame>
        
        <!-- Log Entries Section -->
        <Frame Grid.Row="2" 
               BackgroundColor="{AppThemeBinding Light=White, Dark=#1E1E1E}"
               BorderColor="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"
               Padding="5">
            <Grid RowDefinitions="Auto,*">
                <Label Grid.Row="0" 
                       x:Name="LogCountLabel"
                       Text="Log Entries" 
                       FontSize="16" 
                       FontAttributes="Bold" 
                       Margin="5"/>
                
                <CollectionView Grid.Row="1" 
                               x:Name="LogEntriesCollectionView">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnDefinitions="Auto,Auto,*,*" ColumnSpacing="5" Padding="5" 
                                  BackgroundColor="{AppThemeBinding Light=Transparent, Dark=Transparent}">
                                <Label Grid.Column="0" 
                                       Text="{Binding FormattedTimestamp}" 
                                       FontSize="10" 
                                       FontFamily="Courier New"
                                       TextColor="Gray" 
                                       VerticalOptions="Start"/>
                                <Label Grid.Column="1" 
                                       Text="{Binding FormattedLevel}" 
                                       FontSize="10" 
                                       FontFamily="Courier New"
                                       TextColor="{Binding LevelColor}" 
                                       FontAttributes="Bold"
                                       VerticalOptions="Start"/>
                                <Label Grid.Column="2" 
                                       Text="{Binding FormattedCategory}" 
                                       FontSize="11" 
                                       TextColor="{AppThemeBinding Light=#666666, Dark=#CCCCCC}"
                                       VerticalOptions="Start"/>
                                <Label Grid.Column="3" 
                                       Text="{Binding Message}" 
                                       FontSize="11" 
                                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                       VerticalOptions="Start"
                                       LineBreakMode="WordWrap"/>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>
        </Frame>
        
        <!-- Status Bar -->
        <Frame Grid.Row="3" 
               BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#1A1A1A}"
               BorderColor="Transparent"
               Padding="10,5"
               Margin="0,10,0,0">
            <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
                <Label Grid.Column="0"
                       x:Name="StatusLabel" 
                       Text="Ready" 
                       FontSize="12"
                       VerticalOptions="Center"/>
                <Button Grid.Column="1"
                        x:Name="ClearAllButton"
                        Text="Clear All Logs"
                        FontSize="12"
                        BackgroundColor="Orange"
                        TextColor="White"
                        Clicked="OnClearAllLogsClicked"/>
                <Button Grid.Column="2"
                        x:Name="CloseButton"
                        Text="Close"
                        FontSize="12"
                        Clicked="OnCloseClicked"/>
            </Grid>
        </Frame>
    </Grid>
</ContentPage>